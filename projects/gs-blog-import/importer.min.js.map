{"version":3,"sources":["projects/gs-blog-import/importer.js"],"names":["addEvent","element","event","listener","attachEvent","addEventListener","WP","name","root","item","props","site","posts","map","title","mapTo","cdata","pubDate","dc:creator","content:encoded","content:excerpt","wp:post_name","categories","wp:status","mapNM","app","getOption","id","result","option","document","getElementById","getElementsByName","type","value","checked","options","selectedIndex","i","length","gsXML","this","data","node","children","prototype","set","prop","cache","get","subitem","key","view","previewIndex","previewMode","updateFileInfo","el","prefix","warn","indexOf","textContent","className","innerHTML","readXml","file","callback","reader","FileReader","onload","e","target","srcElement","DOMParser","parseFromString","cms","xml","fileSize","Math","floor","size","fileName","fileType","slice","lastIndexOf","defineXmlns","extractSiteProps","extractPosts","extractPostProps","readAsText","nName","nValue","getElementsByTagName","attrs","attributes","nodeName","nodeValue","split","getElementsByNameNS","doc","tagName","getElementsByTagNameNS","trim","tag","push","postXml","previewPosts","row","vCol","tCol","appendTo","output","createElement","jsPost","appendChild","createTextNode","outerHTML","generatePostXml","pretty","content","processPost","post","url","regex","replace","RegExp","generatePostsOutput","convertPosts","tree","arr","console","log","metad","json","join","call","jsPosts","processedContent","hasOwnProperty","author","user","template","parent","bindClick","parentNode","zip","JSZip","generate","saveAs","files","body","onchange","toLowerCase"],"mappings":"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","file":"importer.min.js","sourcesContent":["/** GS Posts import - Import Wordpress (& in the future other CMS'es) blog posts easily to GetSimple CMS. \n *  Version 0.1 - 4th of June 2015\n *  By Kevin Van Lierde (tyblitz) - webketje.com\n *  Contact me via kevin.van.lierde@gmail.com or via Twitter [@]Tyblitz\n *  Copyright 2015\n *  \n * The MIT License (MIT)\n * Copyright (c) 2015 Kevin Van Lierde\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n *\n *  A quick roundup of the functions inside the anonymous closure\n *  -------------------------------------------------------------\n *  XML preps:\n *    - app.readXml | reads the file input, updates file properties, & sets app.cache.xml\n *    - app.defineXmlns | retrieves the xmlns attributes from the XML root & sets it to app.cache.xmlns\n *    - app.getElementsByNameNS | retrieves a (name-spaced) element from the XML doc; uses app.cache.xmlns\n *  XML processing:\n *    - app.extractSiteProps | sets all properties in app.cache.cms to app.cache._site; launched in app.readXml\n *    - app.extractPosts | sets app.cache.__posts & app.cache.filePosts; launched in app.readXml\n *    - app.extractPostProps | maps individual post properties; called in app.extractPosts or its callback\n *  Display:\n *    - app.view.updateFileInfo | updates file info in step 1000\n *    - app.previewPosts | previews the post from app.cache.posts with index app.view.previewIndex\n *  Output:\n *    - app.generatePostXml | returns the GS page XML for 1 post passed to it (after having been mapped with app.cache.cms.map)\n *    - app.generatePostsOutput | generates a JSON GS tree & corresponding XML string (using app.generatePostXml) & returns an array of all posts\n *    - app.processPost | processes a post with the current options for export (returns it); used in CMS-specific convertPosts function\n *  \n *  Except for these, every CMS requires a name.convertPosts function for final export, and may optionally add a function:\n *  - name.processPostContent (hook in app.processPost)\n *  - name.extractPostProps (hook as callback in app.extractPosts, as passed in app.readXml)\n *  \n */\n\n\n(function() {\n\n\t\"use strict\";\n\t\n\t// IE8 polyfill\n\t\n\tfunction addEvent(element, event, listener) {\n\t  if (element.attachEvent)\n\t    element.attachEvent('on' + event, listener);\n\t  else if (element.addEventListener)\n\t\t\telement.addEventListener(event, listener, false);\n\t}\n\t\n\t// The WP object holds all properties to be saved from a WP export file\n\t// props.site holds site-wide properties, direct children of the root <rss> element.\n\t// props.posts holds properties to be used in app.extractPosts\n\t// from.posts holds a map for mapping post properties to a GS xml page file\n\t\n\t// function getOption retrieves options from the WP form\n\t// @param {string} id - ID (or name for option inputs) of the element whose value to retrieve\n\t\n\tvar WP = {\n\t\tname: 'Wordpress',\n\t\troot: 'rss',\n\t\titem: 'item',\n\t\tprops: {\n\t\t\tsite: ['title','link','description','pubDate','language','wp:wxr_version','wp:base_site_url','wp:base_blog_url','wp:author_email','wp:author_display_name','wp:author_first_name','wp:author_last_name','generator'],\n\t\t\tposts: ['title','link','pubDate','dc:creator','content:encoded','wp:post_date','wp:post_date_gmt','wp:post_name','wp:status']\n\t\t},\n\t\tmap: {\n\t\t\t\t\t\t'title': {mapTo: 'title',   cdata: true },\n\t\t\t\t\t'pubDate': {mapTo: 'pubDate', cdata: false},\n\t\t\t 'dc:creator': {mapTo: 'user',    cdata: true },\n  'content:encoded': {mapTo: 'content', cdata: true },\n  'content:excerpt': {mapTo: 'metad',   cdata: true },\n// 'wp:post_date_gmt': {mapTo: 'creDate', cdata: false},\n\t\t 'wp:post_name': {mapTo: 'url',     cdata: true },\n\t\t   'categories': {mapTo: 'meta',    cdata: true },\n\t\t    'wp:status': {mapTo: 'private' }\n\t\t},\n\t\tmapNM: {\n\t\t\t\t\t\t'title': {mapTo: 'title',   cdata: true },\n\t\t\t\t\t'pubDate': {mapTo: 'date',    cdata: false},\n\t\t\t 'dc:creator': {mapTo: 'user',    cdata: true },\n  'content:encoded': {mapTo: 'content', cdata: true },\n  'content:excerpt': {mapTo: 'metad',   cdata: true },\n// 'wp:post_date_gmt': {mapTo: 'creDate', cdata: false},\n\t\t 'wp:post_name': {mapTo: 'url',     cdata: true },\n\t\t   'categories': {mapTo: 'tags',    cdata: true }\n\t\t},\n\t},\n\tapp = {};\n\t\n\tapp.getOption = function(id) {\n\t\tvar option = document.getElementById(id) ? document.getElementById(id) : document.getElementsByName(id), \n\t\t\tresult;\n\t\tif (option.type === 'text')\n\t\t\tresult = option.value;\n\t\telse if (option.type === 'checkbox')\n\t\t\tresult = option.checked;\n\t\telse if (option.type === 'select')\n\t\t\tresult = option.options[option.selectedIndex].value;\n\t\telse if (!option.id) {\n\t\t\tfor (var i = 0; i < option.length; i++) {\n\t\t\t\tif (option[i].checked === true)\n\t\t\t\t\tresult = option[i].value;\n\t\t\t}\t\t\t\t\t\n\t\t}\n\t\treturn result;\n\t};\n\tapp.gsXML = function() {\n\t  this.data = { node: 'item', children: [\n\t\t\t{node: 'title', cdata: true},\n\t\t\t{node: 'url', cdata: true},\n\t\t\t{node: 'pubDate', cdata: false},\n\t\t\t{node: 'author', cdata: true},\n\t\t\t{node: 'meta', cdata: true},\n\t\t\t{node: 'metad', cdata: true},\n\t\t\t{node: 'menu', cdata: true},\n\t\t\t{node: 'menuOrder', cdata: true},\n\t\t\t{node: 'menuStatus', cdata: true},\n\t\t\t{node: 'template', cdata: true},\n\t\t\t{node: 'parent', cdata: true},\n\t\t\t{node: 'content', cdata: true}\n\t\t]};\n\t};\n\tapp.gsXML.prototype.set = function(item, prop, value) {\n\t\tfor (var i = 0; i < this.data.children.length; i++) {\n\t\t\tif (this.data.children[i].node === item) {\n\t\t\t\tthis.data.children[i][prop] = value;\n\t\t\t}\n\t\t}\t\t\n\t};\n\t\n\t// app.cache is dynamically populated with the following sub-objects/ properties\n\t// Meta-data related to the file: fileSize, fileType, fileName, filePosts\n\t// __posts & _site: objects with original XML tags as keys & original content as values\n\t// _posts: objects with converted xml tags as keys & converted content as values\n\t// posts: objects containing both xml & json nodes with the latter having a structure like app.gsXML\n\t\n\tapp.cache = {\n\t\tget: function(item, subitem) {\t\n\t\t\tif (subitem)\n\t\t\t\treturn app.cache[item][subitem] || false;\n\t\t\telse\n\t\t\t\treturn app.cache[item] || false; \n\t\t},\n\t\tset: function(item, value) { \n\t\t\tif (typeof item === 'string')\n\t\t\t\tapp.cache[item] = value; \n\t\t\telse {\n\t\t\t\tfor (var key in item) \n\t\t\t\t\tapp.cache[key] = item[key];\n\t\t\t}\n\t\t}\n\t};\n\t\n\t// only WP at the moment\n\tapp.cache.set('cms', WP);\n\t\n\t// app.view holds some state properties concerning the app's view\n\t\n\tapp.view = {\n\t\tpreviewIndex: 0,\n\t\tpreviewMode: 'table'\n\t};\n\t\n\t// update file info in the UI\n\t\n\tapp.view.updateFileInfo = function() {\n\t\tvar props = [\n\t\t\t{el: 'file-name', data: app.cache.get('fileName'), prefix: 'File name:', warn: function(item) { return item.indexOf('.xml') === -1}}, \n\t\t\t{el: 'file-size', data: app.cache.get('fileSize'), prefix: 'File size:'}, \n\t\t\t{el: 'file-posts',data: app.cache.get('filePosts'),prefix: 'Posts:',     warn: function(item) { return item > 1000 || item === 'Error' }}, \n\t\t\t{el: 'file-type', data: app.cache.get('fileType'), prefix: 'File type:', warn: function(item) { return item !== 'text/xml'}}\n\t\t];\n\t\tfor (var i = 0; i < props.length; i++) {\n\t\t\tdocument.getElementById(props[i].el).textContent = props[i].prefix + ' ' + props[i].data;\n\t\t\tif (props[i].warn && props[i].warn(props[i].data)) {\n\t\t\t\tdocument.getElementById(props[i].el).className = 'uk-alert-danger';\n\t\t\t\tdocument.getElementById(props[i].el).innerHTML = '<i class=\"uk-icon-close\"></i>&nbsp;&nbsp;' + document.getElementById(props[i].el).innerHTML;\n\t\t\t} else if (props[i].el !== 'file-size') {\n\t\t\t\tdocument.getElementById(props[i].el).className = 'uk-alert-success';\n\t\t\t\tdocument.getElementById(props[i].el).innerHTML = '<i class=\"uk-icon-check\"></i>&nbsp;&nbsp;' + document.getElementById(props[i].el).innerHTML;\n\t\t\t}\n\t\t}\n\t};\n\t\n\t// processes input from the file input, making use of FileReader & DOMParser API\n\t// @param file - data as gotten from the file input\n\t// @param callback - a function to execute after file read has completed\n\t// sets app.cache.xml\n\t\n\tapp.readXml = function (file, callback) { \n    var reader = new FileReader();\n    reader.onload = success;  \n    \n    function success(e) { \n     \n\t\t\tvar target = e.target || e.srcElement,\n\t\t\t\t\tparser = new DOMParser(),\n\t\t\t\t\tresult = parser.parseFromString(target.result, 'application/xml'),\n\t\t\t\t\tcms = app.cache.get('cms');\n\t\t\t\t\t\n\t\t\tapp.cache.set({\n\t\t\t\txml: result,\n\t\t\t\tfileSize: Math.floor(file.size/1024, 2) + ' KB',\n\t\t\t\tfileName: file.name,\n\t\t\t\tfileType: file.type ? file.type : file.name.slice(file.name.lastIndexOf('.') + 1)\n\t\t\t});\n\t\t\t\n\t\t\tapp.defineXmlns();\n\t\t\tapp.extractSiteProps(cms.props.site);\n\t\t\tapp.extractPosts(cms.item, cms.props.posts, cms.extractPostProps);\n\t\t\tapp.view.updateFileInfo();\n    }   \n    \n    reader.readAsText(file);                                              \n\t} \n\t\n\t// defines the namespaces used by the getElementsByTagNameNS function\n\t// I: raw XML as gotten from app.cache.xml\n\t// O: an object with namespace names as keys & namespace URI's as value\n\t// sets app.cache.xmlns\n\t\n\tapp.defineXmlns = function() {\n\t\tvar root = app.cache.get('xml').getElementsByTagName(app.cache.get('cms','root'))[0],\n\t\t\t\tattrs = {}, nName, nValue;\n\t\tif (root) {\n\t\t\tfor (var i = 0; i < root.attributes.length; i++) {\n\t\t\t\tnName = root.attributes[i].nodeName;\n\t\t\t\tnValue = root.attributes[i].nodeValue;\n\t\t\t\tif (nName.indexOf('xmlns') > -1) {\n\t\t\t\t\tattrs[nName.split(':')[1]] = nValue;\n\t\t\t\t}\n\t\t\t}\n\t\t\tapp.cache.set('xmlns', attrs);\n\t\t}\n\t};\n\t\n\t// retrieves elements in an XML document, both with & without namespace.\n\t// @param {XMLElement|XMLDocument} doc - the root from which to search for the element\n\t// @param {string} tagName - the name of the element to search for\n\t\n\tapp.getElementsByNameNS = function(doc, tagName) {\n\t\tvar tagName = tagName;\n\t\tif (tagName.indexOf(':') > -1) {\n\t\t\ttagName = tagName.split(':');\n\t\t\treturn doc.getElementsByTagNameNS(app.cache.get('xmlns')[tagName[0]], tagName[1])[0];\n\t\t} else {\n\t\t\treturn doc.getElementsByTagName(tagName)[0];\n\t\t}\n\t};\n\t\n\t// sets app.cache._site\n\t\n\tapp.extractSiteProps = function(props) {\n\t\tvar result = {};\n\t\tfor (var i = 0; i < props.length; i++) {\n\t\t\tif (app.getElementsByNameNS(app.cache.xml, props[i]))\n\t\t\tresult[props[i]] = app.getElementsByNameNS(app.cache.xml, props[i]).textContent.trim();\n\t\t}\n\t\tapp.cache.set('_site', result);\n\t\treturn result;\n\t};\n\t\n\t// sets app.cache.__posts & app.cache.filePosts\n\t// @param {string} tag - the container tag for one post item \n\t// @param {array} props - properties to pass to callback for processing\n\t// @param {function} callback - a function to process post items & their properties\n\t// the callback function should first include a call to app.extractPostProps.call()\n\t\n\tapp.extractPosts = function(tag, props, callback) {\n\t\tvar posts = app.cache.xml.getElementsByTagName(tag),\n\t\t\t\tresult = [], post;\n\t\tfor (var i = 0; i < posts.length; i++) {\n\t\t\tresult.push(callback(posts[i], props));\n\t\t}\n\t\tapp.cache.set('__posts', result);\n\t\tapp.cache.set('filePosts', posts.length ? posts.length : 'Error');\n\t};\n\t\n\t// extractPostProps called as (part of) callback in app.extractPosts\n\t// @param {object} postXml - xml of an individual post item\n\t\n\tapp.extractPostProps = function(postXml, props) {\n\t\tvar result = {};\n\t\tfor (var i = 0; i < props.length; i++) {\n\t\t\tif (app.getElementsByNameNS(postXml, props[i]))\n\t\t\t\tresult[props[i]] = app.getElementsByNameNS(postXml, props[i]).textContent.trim();\n\t\t}\n\t\treturn result;\n\t};\n\t\t\n\t// generates a preview in the preview window\n\t// @param {object} jsPost - a post item to preview\n\t// @param {number} i - the index of the post to preview\n\t// TODO: pass the post directly\n\t\n\tapp.previewPosts = function() {\n\t\t\n\t\tvar tag, value, row, vCol, tCol, \n\t\t\tappendTo = document.getElementById('preview'),\n\t\t\toutput = document.createElement('table'), \n\t\t\tjsPost = app.cache.get('_posts')[app.view.previewIndex];\n\t\tif (app.getOption('view-mode') === 'view-table') {\n\t\t\toutput.className = 'uk-table uk-table-condensed';\n\t\t\tfor (var prop in jsPost) {\n\t\t\t\ttag = document.createElement('code');\n\t\t\t\ttag.appendChild(document.createTextNode('<' + prop + '>'));\n\t\t\t\tvalue = document.createTextNode(jsPost[prop]);\n\t\t\t\trow = document.createElement('tr');\n\t\t\t\ttCol = document.createElement('td');\n\t\t\t\tvCol = document.createElement('td');\n\t\t\t\ttCol.appendChild(tag);\n\t\t\t\tvCol.appendChild(value);\n\t\t\t\trow.appendChild(tCol);\n\t\t\t\trow.appendChild(vCol);\n\t\t\t\toutput.appendChild(row);\n\t\t\t}\n\t\t} else {\n\t\t\toutput = document.createElement('pre');\n\t\t\toutput.appendChild(document.createTextNode(app.cache.get('posts')[app.view.previewIndex].xml));\n\t\t}\n\t\tappendTo.innerHTML = output.outerHTML;\n\t}\n\t\n\t// builds a GS XML page, used in function app.generatePostXml\n\t\n\tapp.generatePostXml = function(node) {\n\t\tvar output = '<?xml version=\"1.0\" encoding=\"UTF-8\"?>',\n\t\t\t\tpretty = app.getOption('pretty-print');\n\t\tif (pretty) output += '\\n';\n\t\toutput += '<' + node.node + '>';\n\t\tfor (var i = 0; i < node.children.length; i++) {\n\t\t\tif (pretty) \n\t\t\t\toutput += '\\n\\t';\n\t\t\toutput += '<' + node.children[i].node + '>' + (node.children[i].cdata ? '<![CDATA[' + (node.children[i].content ? node.children[i].content : '' ) + ']]>' : node.children[i].content ?  node.children[i].content : '') + '</' + node.children[i].node + '>';\n\t\t}\n\t\tif (pretty) output += '\\n';\n\t\toutput += '</' + node.node + '>';\n\t\treturn output;\n\t}\n\t\t\n\t// function WP.processPost(content), handles output options\n\t// @param content {string} - String XML content to customize\n\t// @param url {string} - the object to make content & metad properties of\n\t// returns object { content: stringOutput, metad: stringOutput }\n\t\n\tapp.processPost = function(post, url) {\n\t\n\t\tvar content = post.content, metad = '', regex = {\n\t\t\thtmlSectioning: /<\\/*(section|main|header|footer|aside|nav).*?>/g,\n\t\t\thtmlDiv: /<\\/*div.*?>/g,\n\t\t\thtmlAll: /<\\/*.*?>/g,\n\t\t\thtmlAttrClass: /\\s*class=\".*?\"/g,\n\t\t\thtmlAttrId: /\\s*id=\".*?\"/g,\n\t\t\thtmlEmpty: /<[^\\/>][^>]*[^\\/]><\\/[^>]+>/,\n\t\t\thtmlLonely: /s/g,\n\t\t\tspaceEntity: /&nbsp;/g,\n\t\t\tspaceCharsPlus: /\\s+/g\n\t\t};\n\t\t\n\t\t// make sure we don't forget to remove unnecessary &nbsp; spaces, convert them first\n\t\tpost.content = content.replace(regex.spaceEntity, ' ');\n\t\tif (app.getOption('trim-whitespace'))\n\t\t\tpost.content = content.replace(regex.spaceCharsPlus, ' ');\n\t\t\n\t\t// hook for CMS-specific functions\n\t\tif (typeof app.cache.cms.processPost === 'function')\n\t\t\tpost = app.cache.cms.processPost(post);\n\t\tcontent = post.content;\n\t\t// handle options\n\t\tif (app.getOption('link-handler') !== 'none') {\n\t\t\tif (app.getOption('link-handler') === 'root-rel')\n\t\t\t\tcontent = content.replace(new RegExp(url, ''));\n\t\t\telse if (app.getOption('link-handler') === 'new-link')\n\t\t\t\tcontent = content.replace(new RegExp(url, app.getOption('new-link-url')));\n\t\t}\n\t\tif (app.getOption('strip-sections'))\n\t\t\tcontent = content.replace(regex.htmlSectioning, '');\n\t\tif (app.getOption('strip-divs'))\n\t\t\tcontent = content.replace(regex.htmlDiv, '');\n\t\tif (app.getOption('strip-id'))\n\t\t\tcontent = content.replace(regex.htmlAttrId, '');\n\t\tif (app.getOption('strip-class'))\n\t\t\tcontent = content.replace(regex.htmlAttrClass, '');\n\t\tif (app.getOption('strip-empty'))\n\t\t\tcontent = content.replace(regex.htmlEmpty, '');\n\t\t\n\t\tpost.content = content;\n\t\treturn post;\n\t};\n\t\n\t// generates output in json tree + xml, both for display in app.previewPosts\n\t// as well as for export (the xml array) & download\n\t\n\tapp.generatePostsOutput = function(posts) {\n\t\tapp.cache.set('_posts', app.cache.get('cms').convertPosts(posts));\n\t\tvar output = '', tree, arr = [], posts = posts || app.cache.get('_posts');\n\t\tfor (var i = 0; i < posts.length; i++) {\n\t\t\ttree = new app.gsXML();\n\t\t\tconsole.log(posts[i].metad);\n\t\t\tfor (var prop in posts[i]) {\n\t\t\t\ttree.set(prop, 'content', posts[i][prop]);\n\t\t\t}\n\t\t\tarr.push({json: tree.data, xml: app.generatePostXml(tree.data)});\n\t\t}\n\t\tapp.cache.set('posts', arr);\n\t\treturn arr;\n\t};\n\t\n\t// app.processPost hook for WP-specific options\n\t\n\tWP.processPost = function(post) {\n\t\tvar content = post.content, metad = post.metad, regex = {\n\t\t\thtmlAll: /<\\/*.*?>/g,\n\t\t\twpShorts: /\\[.*?\\[\\/.*?\\]/g,\n\t\t\twpMoreTag: '<!--more-->'\n\t\t};\n\t\tif (app.getOption('strip-shortcodes')) \n\t\t\tcontent = content.replace(regex.wpShorts, '');\n\t\tif (content.indexOf(regex.wpMoreTag) > 0) {\n\t\t\tcontent = content.split(regex.wpMoreTag);\n\t\t\tif (app.getOption('set-more-metad'))\n\t\t\t\tmetad = content[0].replace(regex.htmlAll, '');\n\t\t\tif (app.getOption('strip-more-text'))\n\t\t\t\tcontent = content[1];\n\t\t\telse\n\t\t\t\tcontent = content.join('');\n\t\t\tif (app.getOption('strip-more-tag'))\n\t\t\t\tcontent = content.replace(regex.wpMoreTag, '');\n\t\t}\n\t\tpost.content = content;\n\t\tpost.metad = metad || '';\n\t\treturn post;\n\t};\n\t\n\t// basically the same as generic postprop extractor,\n\t// except we map individual category fields to one property\n\t\n\tWP.extractPostProps = function(postXml, props) {\n\t\t// result holds an object with all defined tags as children\n\t\t// so we can add a new property to it without problem\n\t\tvar result = app.extractPostProps.call(null, postXml, props),\n\t\t\t\tcategories = postXml.getElementsByTagName('category');\n\t\tresult.categories = [];\n\t\t\n\t\tfor (var i = 0; i < categories.length; i++) {\n\t\t\tresult.categories.push(categories[i].textContent);\n\t\t}\n\t\tresult.categories = result.categories.join(', ');\n\t\treturn result;\n\t};\n\t\n\tWP['convertPosts'] = function(jsPosts) {\n\t\tvar jsPosts = app.cache.get('__posts');\n\t\tvar map = WP.map, result = [], processedContent;\n\t\tfor (var i = 0; i < jsPosts.length; i++) {\n\t\t\tresult[i] = {};\n\t\t\tfor (var prop in jsPosts[i]) {\n\t\t\t\tif (map.hasOwnProperty(prop))\n\t\t\t\t\tresult[i][map[prop].mapTo] = jsPosts[i][prop];\n\t\t\t}\n\t\t\tprocessedContent = app.processPost(result[i], app.cache.get('_site')['wp:base_site_url']);\n\t\t\tresult[i].metad = processedContent.metad;\n\t\t\tresult[i].author = result[i].user;\n\t\t\tresult[i].content = processedContent.content;\n\t\t\tresult[i].template = app.getOption('set-tmpl');\n\t\t\tresult[i].parent = app.getOption('set-parent');\n\t\t}\n\t\treturn result;\n\t};\n\tapp.bindClick = function(e) {\n\t\tvar target = e.target || e.srcElement;\n\t\tif (target.id === 'convert-xml') {\n\t\t\tapp.generatePostsOutput();\n\t    app.previewPosts();\n\t\t} else if (target.id === 'preview-prev' || target.parentNode.id === 'preview-prev') {\n\t\t\tapp.view.previewIndex = app.view.previewIndex - 1 > 0 ? app.view.previewIndex - 1 : 0;\n\t\t  app.previewPosts();\n\t\t} else if (target.id === 'preview-next' || target.parentNode.id === 'preview-next') {\n\t\t\tapp.view.previewIndex = app.view.previewIndex + 1 < app.cache.get('posts').length ? app.view.previewIndex + 1 : app.view.previewIndex;\n\t\t  app.previewPosts();\n\t\t} else if (target.id === 'download-zip') {\n\t\t\tvar posts = app.cache.get('posts'),\n\t\t      zip = new JSZip(), fileName;\n\t\t\tfor (var i = 0; i < posts.length; i++) {\n\t\t\t\tfileName = posts[i].json.children[1].content + '.xml';\n\t\t\t\tzip.file(fileName, posts[i].xml);\n\t\t\t\tconsole.log(zip);\n\t\t\t}\n\t\t\tvar content = zip.generate({type:\"blob\"});\n\t\t\tsaveAs(content, \"posts.zip\");\n\t\t}\n\t}\n\taddEvent(document.getElementById('upload-xml'), 'change', function(e) {\n\t\tvar target = e.target || e.srcElement;\n\t  app.readXml(target.files[0]);\n\t});\n\taddEvent(document.body, 'click', app.bindClick);\n\tdocument.getElementsByName('view-mode')[0].onchange = app.previewPosts;\n\tdocument.getElementsByName('view-mode')[1].onchange = app.previewPosts;\n\t\n\tdocument.getElementById('other-settings').innerHTML = '<tr><th colspan=\"2\">' + app.cache.get('cms','name') + '</th></tr>' + document.getElementById(app.cache.get('cms').name.toLowerCase() + '-settings').innerHTML;\n}());\n\n\t\t/*\n\t\t// this part might be useful for unmapping unknown tags\n\t\tfunction iter(node, obj) {\n\t\t\tvar result = obj || {};\n\t\t\tif (node.nodeType === 1 && node.childNodes.length) {\n\t\t\t\tresult[node.nodeName.toLowerCase()] = {};\n\t\t\tfor (var i = 0; i < node.childNodes.length; i++) {\n\t\t\t\titer(node.childNodes[i], result[node.nodeName.toLowerCase()]);\n\t\t\t}\n\t\t\t} else if (node.nodeType === 3 ||node.nodeType === 8  ) {\n\t\t\t\tresult[node.nodeName.toLowerCase()] = node.textContent;\n\t\t\t} \n\t\t\treturn result;\n\t\t} */"]}